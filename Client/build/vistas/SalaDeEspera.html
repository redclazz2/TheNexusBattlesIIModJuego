<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="../css/SalaDeEspera.css">
<link rel="stylesheet" href="../css/normalize.css">
<link href="https://fonts.googleapis.com/css2?family=Barlow:wght@500;600;800&family=Irish+Grover&family=Playfair+Display:wght@700&family=Raleway:wght@400;700;900&display=swap" rel="stylesheet">
<title>Sala de espera</title>
</head>

<script>//posiblemente a eliminar
  fetch('https://') //url pendiente    
  .then(response => response.json())
  .then(newPlayerData => {
    // Actualiza la interfaz de usuario con el nombre del jugador en el label correspondiente
    const jugadorLabel = document.getElementById(`labelJugador${newPlayerData.id}`);//revisar parametros pendiente
    if (jugadorLabel) {
      jugadorLabel.textContent = newPlayerData.user;
    }
  })
  .catch(error => {
    console.error('Error al obtener los datos del jugador recién ingresado: ', error);
  });
</script>

<script>
  const apiUrl = '';  //aquí se hace la lectura de las cadenas entregadas

        // Función para obtener y mostrar los datos del perfil
        function obtenerPerfil() {
            fetch(apiUrl)
                .then(response => response.json())
                .then(data => {
                    const perfilData = document.getElementById('perfilData');
                    perfilData.textContent = JSON.stringify(data, null, 4);
                })
                .catch(error => {
                    console.error('Error al obtener el perfil:', error);
                });
        }

        // Función para obtener y mostrar los datos del inventario
        function obtenerInventario() {
            fetch(apiUrl)
                .then(response => response.json())
                .then(data => {
                    const inventarioList = document.getElementById('inventarioList');
                    data.inventario.forEach(item => {
                        const listItem = document.createElement('li');
                        listItem.textContent = `ID: ${item.id}, Usuario: ${item.user}, ID Carta: ${item.id_carta}`;
                        inventarioList.appendChild(listItem);
                    });
                })
                .catch(error => {
                    console.error('Error al obtener el inventario:', error);
                });
        }

        // Llamar a las funciones para obtener los datos
        obtenerPerfil();
        obtenerInventario();
</script>

<script>// este es el actual-------------------------------------------------------------------------------------------------------------------
  const apiUrl = '';  //aquí se hace la lectura de las cadenas entregadas

// Variables locales para almacenar datos individuales
let userId = null;
let userName = null;
let userGames = null;
let userSub = null;
let userCredits = null;

// Variable local para almacenar datos del inventario
let inventarioItems = [];

// Función para obtener y guardar los datos del perfil
function obtenerPerfil() {
    fetch(apiUrl)
        .then(response => response.json())
        .then(data => {
            // Guardar datos del perfil en variables locales
            userId = data.id;
            userName = data.user;
            userGames = data.games;
            userSub = data.sub;
            userCredits = data.credits;

            // Puedes acceder a los datos del perfil individualmente a través de las variables locales
            console.log('ID del usuario:', userId);
            console.log('Nombre de usuario:', userName);
            console.log('Número de juegos:', userGames);
            console.log('¿Es subscriptor?', userSub);
            console.log('Créditos:', userCredits);
        })
        .catch(error => {
            console.error('Error al obtener el perfil:', error);
        });
}

// Función para obtener y guardar los datos del inventario
function obtenerInventario() {
    fetch(apiUrl)
        .then(response => response.json())
        .then(data => {
            // Guardar datos del inventario en la variable local
            inventarioItems = data.inventario;

            // Puedes acceder a los datos del inventario a través de la variable local inventarioItems
            console.log('Inventario:', inventarioItems);
        })
        .catch(error => {
            console.error('Error al obtener el inventario:', error);
        });
}

// Llamar a las funciones para obtener los datos
obtenerPerfil();
obtenerInventario();
</script>

<script> //actualiza nombre de jugadores
  const apiUrl = '';

  // Función para obtener los nombres de usuario de la API
  async function obtenerNombresDeUsuarios() {
    try {
      const response = await fetch(apiUrl);
      const data = await response.json();
      return data;
    } catch (error) {
      console.error('Error al obtener los nombres de usuario:', error);
      return [];
    }
  }

  // Función para actualizar los nombres de los jugadores
  async function actualizarNombresDeJugadores() {
    const jugadores = document.querySelectorAll('.labelJugador');
    const nombresDeUsuarios = await obtenerNombresDeUsuarios();
    for (let i = 0; i < nombresDeUsuarios.length && i < jugadores.length; i++) {
      jugadores[i].textContent = `Jugador ${i + 2}: ${nombresDeUsuarios[i]}`;
    }
  }

  // Llama a la función para actualizar los nombres de los jugadores
  actualizarNombresDeJugadores();
</script>

<script>
  function recibirOrdenDelServidor(orden) {
    if (orden === 'Jugadores listos') {
      // Cambia el texto en la vista de sala de espera
      const textoEsperar = document.getElementById('textoEsperar');
      textoEsperar.textContent = 'Jugadores listos';
    }
  }
</script>

<body>
  <div id="title-box">
    <a class="botonMenu1" href="./ConfiguracionSala.html">Atrás</a>
    Sala de espera
    <button class="botonMenu2" id="crearSalaBoton">Iniciar Partida</button>
  </div>
  <div id="contenedorPrincipal">
    <div id = estadoSala>
        <div id="textoEsperar">Esperando Jugadores...</div>
      </div>
    <div class="jugadores">
      
      <div id="jugador">
        <div class="labelJugador" id="labelJugador1">Anfitrión</div>
      </div>
      <div id="jugador">
        <div class="labelJugador" id="labelJugador2">Jugador 2</div>
      </div>
      <div id="jugador">
        <div class="labelJugador" id="labelJugador3">Jugador 3</div>
      </div>
      <div id="jugador">
        <div class="labelJugador" id="labelJugador4">Jugador 4</div>
      </div>  
    </div>
  </div>

  <div id="overlay"></div>
  <div id="popup">
    <p>No tienes las cartas suficientes para continuar</p>
    <button id="cerrarPopup">Cerrar</button>
  </div>

  <div id="overlay"></div>
  <div id="popupCreditos">
    <p>No tienes los suficientes creditos para la apuesta</p>
    <button id="cerrarPopupCreditos">Cerrar</button>
  </div>

  <script>
    // script para el cuadro emergente a falta de cartas
    function mostrarPopup() {
      document.getElementById("overlay").style.display = "block";
      document.getElementById("popup").style.display = "block";
    }

    // Función para cerrar el cuadro emergente
    function cerrarPopup() {
      document.getElementById("overlay").style.display = "none";
      document.getElementById("popup").style.display = "none";
    }

    // Agregar un evento al botón "Iniciar Partida" para mostrar el cuadro emergente
    document.getElementById("---crearSalaBoton").addEventListener("click", mostrarPopup);//función inhabilitada tempotalmente

    // Agregar un evento al botón "Cerrar" en el cuadro emergente para cerrarlo
    document.getElementById("cerrarPopup").addEventListener("click", cerrarPopup);
  </script>

  <script>
    // script para el cuadro emergente a falta de creditos
    function mostrarPopupCreditos() {
      document.getElementById("overlay").style.display = "block";
      document.getElementById("popupCreditos").style.display = "block";
    }

    // Función para cerrar el cuadro emergente
    function cerrarPopupCreditos() {
      document.getElementById("overlay").style.display = "none";
      document.getElementById("popupCreditos").style.display = "none";
    }

    // Agregar un evento al botón "Iniciar Partida" para mostrar el cuadro emergente
    document.getElementById("---crearSalaBoton").addEventListener("click", mostrarPopupCreditos);//función inhabilitada tempotalmente

    // Agregar un evento al botón "Cerrar" en el cuadro emergente para cerrarlo
    document.getElementById("cerrarPopupCreditos").addEventListener("click", cerrarPopupCreditos);
  </script>
</body>
</html>
